package verify

//||------------------------------------------------------------------------------------------------||
//|| Import
//||------------------------------------------------------------------------------------------------||

import (
	"time"

	"github.com/complyage/base/types"
	"github.com/google/uuid"
	"github.com/ralphferrara/aria/app"
)

//||------------------------------------------------------------------------------------------------||
//|| Create a Verification
//||------------------------------------------------------------------------------------------------||

func Create(dataType types.DataType, account types.AccountSessionChecked) Verification {
	app.Log.Data("Verify: Init Verification")
	//||------------------------------------------------------------------------------------------------||
	//|| Start a Verification
	//||------------------------------------------------------------------------------------------------||
	vUUID := uuid.NewString()
	//||------------------------------------------------------------------------------------------------||
	//|| Create a Verification
	//||------------------------------------------------------------------------------------------------||
	verification := Verification{
		Account:          account,
		CanReset:         false,
		ResetAttempts:    0,
		Status:           STATUSES.Pending,
		UUID:             vUUID,
		Type:             dataType,
		Timestamp:        time.Now().UTC(),
		Data:             Data{},
		IdentityUpdated:  false,
		TransactionSaved: false,
	}
	//||------------------------------------------------------------------------------------------------||
	//|| Updated
	//||------------------------------------------------------------------------------------------------||
	verification.Updated()
	//||------------------------------------------------------------------------------------------------||
	//|| Steps
	//||------------------------------------------------------------------------------------------------||
	verification.StepsInit()
	//||------------------------------------------------------------------------------------------------||
	//|| Create a Verification
	//||------------------------------------------------------------------------------------------------||
	verification.TwoFactorInit()
	//||------------------------------------------------------------------------------------------------||
	//|| Create a Verification
	//||------------------------------------------------------------------------------------------------||
	return verification
}
