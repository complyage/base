package verify

import (
	"time"

	"github.com/complyage/base/types"
	"github.com/ralphferrara/aria/app"
)

//||------------------------------------------------------------------------------------------------||
//|| Main Verification
//||------------------------------------------------------------------------------------------------||

type Verification struct {
	//||------------------------------------------------------------------------------------------------||
	//|| Error Levels
	//||------------------------------------------------------------------------------------------------||
	UUID string `json:"uuid"`
	//||------------------------------------------------------------------------------------------------||
	//|| DB Fields
	//||------------------------------------------------------------------------------------------------||
	Status  StatusType     `json:"status"`
	Type    types.DataType `json:"type"`
	Display string         `json:"display"`
	//||------------------------------------------------------------------------------------------------||
	//|| Can Reset
	//||------------------------------------------------------------------------------------------------||
	CanReset      bool `json:"can_reset"`
	ResetAttempts int  `json:"reset_attempts"`
	//||------------------------------------------------------------------------------------------------||
	//|| Process
	//||------------------------------------------------------------------------------------------------||
	Level int    `json:"level"`
	Step  int    `json:"step"`
	Steps []Step `json:"steps"`
	//||------------------------------------------------------------------------------------------------||
	//|| Approval
	//||------------------------------------------------------------------------------------------------||
	Moderate  Moderate  `json:"approval,omitempty"`
	TwoFactor TwoFactor `json:"twofactor,omitempty"`
	//||------------------------------------------------------------------------------------------------||
	//|| Process
	//||------------------------------------------------------------------------------------------------||
	Timestamp time.Time `json:"created"`
	UpdatedAt time.Time `json:"updated"`
	Completed time.Time `json:"completed,omitempty"`
	//||------------------------------------------------------------------------------------------------||
	//|| Private Data - Removed On Save
	//||------------------------------------------------------------------------------------------------||
	IdentityUpdated  bool                        `json:"identityUpdated"`
	TransactionSaved bool                        `json:"transactionSaved"`
	EncryptedSaved   bool                        `json:"encryptedSaved"`
	Account          types.AccountSessionChecked `json:"account"`
	Data             Data                        `json:"data,omitempty"`
}

//||------------------------------------------------------------------------------------------------||
//|| Error Levels
//||------------------------------------------------------------------------------------------------||

type VerificationFinal struct {
	//||------------------------------------------------------------------------------------------------||
	//|| Error Levels
	//||------------------------------------------------------------------------------------------------||
	UUID string `json:"uuid"`
	//||------------------------------------------------------------------------------------------------||
	//|| DB Fields
	//||------------------------------------------------------------------------------------------------||
	Status  StatusType     `json:"status"`
	Type    types.DataType `json:"type"`
	Display string         `json:"display"`
	//||------------------------------------------------------------------------------------------------||
	//|| Process
	//||------------------------------------------------------------------------------------------------||
	Level int    `json:"level"`
	Step  int    `json:"step"`
	Steps []Step `json:"steps"`
	//||------------------------------------------------------------------------------------------------||
	//|| Approval
	//||------------------------------------------------------------------------------------------------||
	Moderate Moderate `json:"approval,omitempty"`
	//||------------------------------------------------------------------------------------------------||
	//|| Process
	//||------------------------------------------------------------------------------------------------||
	Timestamp time.Time `json:"created"`
	Completed time.Time `json:"completed,omitempty"`
}

//||------------------------------------------------------------------------------------------------||
//|| Step
//||------------------------------------------------------------------------------------------------||

type Step struct {
	Type      app.ConstantsEntry `json:"type"`
	Timestamp time.Time          `json:"timestamp"`
	Details   string             `json:"details,omitempty"`
}

//||------------------------------------------------------------------------------------------------||
//|| Moderate
//||------------------------------------------------------------------------------------------------||

type Moderate struct {
	Status    string    `json:"status"`
	Moderator string    `json:"moderator,omitempty"`
	Timestamp time.Time `json:"timestamp,omitempty"`
	Details   string    `json:"details,omitempty"`
}
