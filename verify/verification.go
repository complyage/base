package verify

import (
	"time"

	"github.com/ralphferrara/aria/db"
	"github.com/ralphferrara/aria/storage"
)

//||------------------------------------------------------------------------------------------------||
//|| Error Levels
//||------------------------------------------------------------------------------------------------||

type Verification struct {
	//||------------------------------------------------------------------------------------------------||
	//|| Error Levels
	//||------------------------------------------------------------------------------------------------||
	UUID string `json:"uuid"`
	//||------------------------------------------------------------------------------------------------||
	//|| DB Fields
	//||------------------------------------------------------------------------------------------------||
	FidAccount int64      `json:"fidAccount"`
	Status     StatusType `json:"status"`
	Type       DataType   `json:"type"`
	Display    string     `json:"display"`
	//||------------------------------------------------------------------------------------------------||
	//|| Can Reset
	//||------------------------------------------------------------------------------------------------||
	CanReset      bool `json:"can_reset"`
	ResetAttempts int  `json:"reset_attempts"`
	//||------------------------------------------------------------------------------------------------||
	//|| Process
	//||------------------------------------------------------------------------------------------------||
	Level int    `json:"level"`
	Step  int    `json:"step"`
	Steps []Step `json:"steps"`
	//||------------------------------------------------------------------------------------------------||
	//|| Approval
	//||------------------------------------------------------------------------------------------------||
	Moderate    Moderate          `json:"approval,omitempty"`
	TwoFactor   TwoFactor         `json:"twofactor,omitempty"`
	Transaction TransactionPublic `json:"transaction,omitempty"`
	//||------------------------------------------------------------------------------------------------||
	//|| Process
	//||------------------------------------------------------------------------------------------------||
	Timestamp time.Time `json:"created"`
	UpdatedAt time.Time `json:"updated"`
	Completed time.Time `json:"completed,omitempty"`
	//||------------------------------------------------------------------------------------------------||
	//|| Private Data
	//||------------------------------------------------------------------------------------------------||
	Database  *db.GormWrapper `json:"-"`
	Identity  Identity        `json:"identity,omitempty"`
	Keys      PrivatePublic   `json:"keys,omitempty"`
	Storage   storage.Storage `json:"-"`
	Encrypted Encrypted       `json:"encrypted,omitempty"`
}

//||------------------------------------------------------------------------------------------------||
//|| Updated
//||------------------------------------------------------------------------------------------------||

func (v *Verification) Updated() {
	v.UpdatedAt = time.Now().UTC()
}
