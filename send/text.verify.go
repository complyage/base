package send

//||------------------------------------------------------------------------------------------------||
//|| Import
//||------------------------------------------------------------------------------------------------||

import (
	"github.com/complyage/base/adapters"

	"github.com/ralphferrara/aria/base/template"
)

//||------------------------------------------------------------------------------------------------||
//|| Init
//||------------------------------------------------------------------------------------------------||

func InitTemplates() {
	template.Register("verify.sms", "./.assets/html/verify.sms.txt")
}

//||------------------------------------------------------------------------------------------------||
//|| SendVerifyText
//||------------------------------------------------------------------------------------------------||

func SendVerifyText(phone, code, lang string) (string, error) {

	//||------------------------------------------------------------------------------------------------||
	//|| Template
	//||------------------------------------------------------------------------------------------------||

	tpl := template.Create("verify.sms")
	tpl.Language = lang
	tpl.Add("VERIFY_CODE", code)

	//||------------------------------------------------------------------------------------------------||
	//|| Modal
	//||------------------------------------------------------------------------------------------------||

	compiledVerify := tpl.Compile()

	//||------------------------------------------------------------------------------------------------||
	//|| Send SMS
	//||------------------------------------------------------------------------------------------------||

	sent, err := adapters.SendText(phone, compiledVerify)
	if err != nil {
		return "", err
	}

	//||------------------------------------------------------------------------------------------------||
	//|| Return Compiled
	//||------------------------------------------------------------------------------------------------||

	return sent, nil
}
